---
title: "An Analysis of Used Car Prices Data"
author: "Kevin Mohammed"
output: html_notebook
---

## Libaries
```{r}
library(tidyverse)
library(dplyr)
library(lubridate)
library(ggplot2)
```



## Summary
> This project's goal is to represent the rate of change in the price of vehicles of varying sizes, then, from my analysis, come up with a conclusion on the rate of change of vehicles throughout each decade. To achieve this, the dplyr package to filter and sort my data into datasets that are focused on what point is being made. Next, the ggplot2 package is used to visualize the data created from the dplyr package. The resulting data frame and graph created will be used to form conclusions about my goal.

## Purpose
>The purpose of this project is to find the average rate of change in prices of vehicles that were released in each decade, to be able to create a general prediction for what we could expect to see when buying a new car over a used one. The behaviour of the graphs created will show how the prices will likely behave in the future. Then, from that, compare how sports car prices throughout the years compare to those of economy cars.

## Data
```{r}
CarSales_Data<-read.csv("car_sales_data.csv")
```

```{r}
Variables_In_Dataset<-list(
  Manufacturer= c("This columns contains the car brands", "Categorical value"),
  Model=c("Tells us what car specifically from the manufacturer we are looking at.","Categorical value"),
  Engine.size=c("The column engine size tells us the amount of air that is displaced after every engine piston stroke.","Numerical value"),
  Fuel.type=c("Used to tell which vehicles are petrol, diesel, or hybrid.", "Catagorical value"),
  Year.of.manufacture=c("States the year the vehicles manufature year.","Numerical Value"),
  Mileage=c("Shows how much milage had been put on a vehicle.","Numerical Value"),
  Price= c("Column that displays the price of these vehicles if they were bought recently.", "Numerical Value")
)
Variables_In_Dataset
```

> b. The data set did not contain any NA values, so no cleaning had to be done.

> c. No, need need to use tidyr to tidy my data or change the dataset fromat.



## Exploratory Data Analysis

```{r}
CarSales_Data%>%
  summary()
```


> From this summary statistic, we can see that the engine sizes featured in the data set range from 1.0 Liters to 5.0 Liters, with an average engine size of around 1.773 Liters. This means most vehicles in the dataset are economy vehicles, built for efficiency. This will be important for my exploration, since the rate of price changes between economy versus sports cars are vbeing compared, Engine Size can potentially be used as a metric to determine whether a car is a sports car or not.

>Mileage shows that the least mileage a vehicle has that is present in the dataset is under 1000 miles, at 630. The 1st Quarter tells us that the 630-mileage vehicle may be an outlier, as it goes up to 54352 miles. The average mileage a vehicle has is 112497 miles, meaning we are working with mostly used vehicles in the dataset.  

>Looking at the price, we can see a large skew in the price as we approach the current day. The 3rd Quarter of the prices go up to $19027, but our max is 168081, so we could expect to see much higher prices from approximately 2010 to 2022. This is important to note because it gives us a rough image of what to expect to happen with prices as you move through the decades, which my data exploration will delve deeper into.

```{r}
CarSales_Data%>%
  group_by(Model)%>%
  summarise()
```
>The summary above shows all 15 vehicle models present in the dataset, ranging from multiple manufacturers. Each car will be sorted into two separate datasets. One dataset will contain economy cars, and the other will be sports cars. These two data sets will be useful later when comparing how their prices change throughout each year. 


```{r}
CarSales_Data%>%
  ggplot(aes(x=Year.of.manufacture))+
  geom_histogram(binwidth = 10, fill="purple", color="black")+
  labs(
    x="Year of Manufacture",
    y="Number of Vehicles",
    title="Cars Manufactured per Decade"
  )
```
> The histogram shows the number of vehicles produced in each decade that are present in the dataset. The x-axis represents the year a car was manufactured in and the y-axis is the count of vehicles in that timeframe. Each bar represents 10 years, so vehicles made in the 80s are shown as the bar above 1980 and so forth. The highest count on the graph is at around 15,000 for cars manufactured in 2010 and 2000, which tells us we will be seeing a lot of vehicles from those two decades. The lowest count is vehicles made in the 80s, which may skew how the prices will look for that decade, as there are not as many vehicles to average out the price.

```{r}
AvgPriceSummary<-CarSales_Data%>%
  group_by(Year.of.manufacture)%>%
  summarise(avgPrice=mean(Price))

AvgPriceSummary%>%
  ggplot(aes(x=Year.of.manufacture, y=avgPrice))+
  geom_line(color="red")+
  labs(title= "Average pirce per Year",
       x="Year of Manufacture",
       y="Average Price")
```
> The graph shown above represents the price of used vehicles produced every year from 1984 to 2022. As the years progress the graph grows at an exponential rate, really growing fast after about 2010 to present day. Since, the graph is a predictable exponential rate of growth it can be used to explain what to expect if a car produced this decade were to be sold in the next decade. We can expect the price to be of cars in the coming years to follow the same exponential growth.

```{r}
#filter cars from each decade
CarsFrom80s<-CarSales_Data%>%
  filter(Year.of.manufacture<1990)%>%
  summarise(avg80Car=mean(Price))

CarsFrom90s<-CarSales_Data%>%
  filter(Year.of.manufacture<2000&Year.of.manufacture>=1990)%>%
  summarise(avg90Car=mean(Price))

CarsFrom2000s<-CarSales_Data%>%
  filter(Year.of.manufacture<2010&Year.of.manufacture>=2000)%>%
  summarise(avg2000Car=mean(Price))

CarsFrom2010s<-CarSales_Data%>%
  filter(Year.of.manufacture<2020&Year.of.manufacture>=2010)%>%
  summarise(avg2010Car=mean(Price))

CarsFrom2020s<-CarSales_Data%>%
  filter(Year.of.manufacture<2030&Year.of.manufacture>=2020)%>%
  summarise(avg2020Car=mean(Price))

averagePriceperDecade<-data.frame(year=c(1980,1990,2000,2010,2020),
                                  averagePrice=c(CarsFrom80s$avg80Car, CarsFrom90s$avg90Car, CarsFrom2000s$avg2000Car, CarsFrom2010s$avg2010Car, CarsFrom2020s$avg2020Car)
                                  )
```

```{r}
averagePriceperDecade%>%
  ggplot(aes(x=year, y=averagePrice))+
  geom_col(fill="darkblue",color="black")+
  labs(
    title = "Average Price per decade",
    x="Year",
    y="Average Price"
  )
```
>The bar graph shows the average price of used vehicles produced from the 80s to 2022. The gowth of the graph is simaliar to the grah before, both featuring an eponential growth, however, since this graph is truncated by each decade the maximum aveage price has decreased now sitting at around $50,000 instead of near $60,000. The reason for this graph is to better represent how to graph the depresiation graph later on using the price averaged per decade.


```{r}

depreciateValuesdf<-data.frame(
  age=c(40, 30, 20, 10),
  depreciateValuesVec=c(1,2,3,4)
)

for (index in 1:length(averagePriceperDecade$averagePrice)) {
  if(index!=5){
    depreciateValuesdf$depreciateValuesVec[index]<- (averagePriceperDecade$averagePrice[index+1]-averagePriceperDecade$averagePrice[index])/10
  }
}
depreciateValuesdf
```
> The "depreciateValuesdf" dataset created above features two variables: age, which is a numerical value that that are separated by intervals of 10, meant to represent each decade. The "depreciateValuesVec" column is also numerical; however, the numbers represent the rate of change of a vehicle's price in a given decade. Each "depreciateValuesVec" value was derived by looping through the "averagePrice" column present in the "averagePriceperDecade" data frame. Then, we retrieve the average price of a vehicle present in the proceeding decade and subtract that value from the average price of a vehicle in the current decade. No values for vehicles produced in 2020 are shown, since the "depreciateValuesVec" value would just be zero. 

```{r}
depreciateValuesdf%>%
  ggplot(aes(x=age, y=depreciateValuesVec))+
  geom_line(color="black")+
  labs(
    x="Age",
    y="Rate of Change",
    title="Depreciation Rate of Change"
  )
```
> By visualizing the data frame created before, with time in years being shown on the x-axis, and the depreciation rate of change value present on the y-axis, it's possible to see how we would expect cars to lose value as they age. When cars get older they tend to lose value quickly after being bought new, then over time, gradually start to slow down after about 20 years of age. From the graph, the depreciation rate of change after 20 years sees a steep fall-off. This means that after buying a vehicle less than a decade old, expect to pay a lot and see a rapid decline in that vehicle's value, whereas an older vehicle would have had a lower initial price and a slower price depreciation rate.

```{r}
#filter economy cars
EconomyCars<-CarSales_Data%>%
  filter(Model==c("Mondeo", "RAV4", "Prius", "Passat"))%>%
  group_by(Year.of.manufacture)%>%
  summarise(avgPrice=mean(Price),
            year=Year.of.manufacture)
```


```{r}
# filter sports cars
SportsCars<-CarSales_Data%>%
  filter(Model==c("Polo", "Focus", "Fiesta", "Golf", "Yaris", "Z4", "Cayenne", "718 cayman", "911"))%>%
  group_by(Year.of.manufacture)%>%
  summarise(avgPrice=mean(Price),
            year=Year.of.manufacture)
```
>

```{r}
ggplot(SportsCars, aes(x=Year.of.manufacture, y=avgPrice))+
  geom_line(color="blue")+
  labs(title = "Sports Cars Average Price per Year",
       x="Year",
       y="Average Price")
```
> Referring back to the graph before that showed the average cost of vehicles made per year, this graph takes on much of the same general features; however visibly this graph is a bit more erratic. fluctuations that spike in some years and reach lows make the graph more unpredictable for creating some kind of prediction model. It's most present after 2000, but remains steady from before the 2000s. These inconsistencies can be caused by many reasons, but the data set variables don't feature anything that would explain this behaviour. This means when buying a sports car, you can expect to see an overall decrease in that car's value, but there will likely be points where the value of that car remains steady for a while, for increases in price.


```{r}
# CarSales_Data%>%
#   group_by(Year.of.manufacture)%>%
#   filter(Manufacturer!="Porsche")%>%
#   summarise(price=sum(Price))
```



```{r}
ggplot(EconomyCars, aes(x=Year.of.manufacture, y=avgPrice))+
  geom_line(color="darkgreen")+
  labs(title = "Economy Cars Average Price per Year",
       x="Year",
       y="Average Price")
```
>Here we see many more similarities with the "average price per year" graph made earlier in the report than the previously seen average sports car prices graph. This is expected as an economy vehicle won't be prone to the same market fluctuations as sports cars. One interesting point to mention is that the peak price for a car made in 2022 is higher than that of a sports car of the same year. It would be interesting to know why this was the case however, like with the sports cars' limitation earlier, there aren't any variables that would explain why economy cars cost as much as they do.


```{r}
engineSize<-CarSales_Data%>%
  group_by(Year.of.manufacture)%>%
  summarise(EngineSize=mean(Engine.size))%>%
  arrange(desc(Year.of.manufacture))

engineSize%>%
  ggplot(aes(x=Year.of.manufacture, y=EngineSize))+
  geom_line(color="darkblue")+
  labs(x="Year", 
       y="Engine Size", 
       title = "Engine Sizes per Year")
```
> The graph above shows the average engine size per year from 1984 to 2022. To try to explain the rapid increase in the prices of vehicles, this graph was created, since it is the only variable present in the data set that could explain the price increases. As we move through the years, it is visible that there is no correlation between engine size and the year of manufacture; therefore, not explain why we see the price trends visible on other graphs.

## Results
> For my data analysis, box plots and line graphs were used to represent the data being shown because line graphs can show the change in price over time the best, while bar graphs are better at representing the average price of vehicles made per decade. These choices made the most sense to reach the goal of this analysis.

> Overall, expect to find vehicles to get cheaper and devalue at a lesser rate as they age. Which is expected since, as seen earlier, the depreciation of a vehicle starts off rapidly, then after about 20 years, it's observed that the rate of depreciation decreases. When comparing the two line graphs that represent the average price per year for year for sports cars and economy cars the the graphs are very comparable. Sports cars seem to fluctuate more in price, while economy cars steadily increase in price. Sports cars have a peak at around $57,000, while economy cars seem to be at $60,000.

## Conclusions
>Overall, saw many of the expected outcomes like price increasing as the year approaches 2022 and decreasing as cars get older. What wasn't expected was to see such a comparable graph between the price of sports cars and economy cars. I was expecting older sports cars to remain higher than economy cars by a significant amount, since they would be more desirable to own compared to economy vehicles of the time. Because the sports cars included are not exclusively high-end sports cars, it's expected to see the modern-day price to be comparable to modern-day economy cars. We can come to the conclusion that the rate of change of car prices will increase as cars become newer or decrease as they become older.

## Resources
>“Car_Sales_Info.” Kaggle, 6 Sept. 2025, www.kaggle.com/datasets/minahilfatima12328/car-sales-info.
